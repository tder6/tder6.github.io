大计几利好难 /kel

机房有大佬发挥人类智慧随机旋转 A 了 /jk

考虑建树（森林），表示圆之间的关系。父亲表示内含，兄弟表示相离但拥有同一父亲。

将每个圆分为上半圆和下半圆两部分，与[扫描线](https://www.luogu.com.cn/problem/P5490)相似，具有函数值大小关系不变的性质。特别的，若一个上半圆的上方距离最近的为上半圆，则显然为其父亲；若其上方距离最近的为下半圆，则为其兄弟。

此处参考扫描线用堆维护即可。

![](https://cdn.luogu.com.cn/upload/image_hosting/dyakxmda.png)

例如，将上图通过上述方式建树后形成的森林应为：

![](https://cdn.luogu.com.cn/upload/image_hosting/ko5u2du8.png)

令一个点的深度为 $d$，则其贡献为 $r^2\times(-1)^{d+1}$，统计答案即可。